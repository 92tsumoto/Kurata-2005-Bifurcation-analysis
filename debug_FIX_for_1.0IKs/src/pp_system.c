#include "syspara.h"

inline void function(double x[],double f[],double t)
{

f[0]=-(icab.pcab*(x[0] - (var.RTF*log(2/x[12]))/2) - var.Istim + inab.pnab*(x[0] - var.RTF*log(var.nao/x[15])) + iks.Gks*x[8]*x[8]*(x[0] - var.RTF*log(iks.k1/(var.ki + var.prnak*x[15]))) + (ncx.c1*(2*x[15]*x[15]*x[15]*exp((7*var.FRT*x[0])/20) - ncx.c2*x[12]*exp(-(13*var.FRT*x[0])/20)))/(exp(-(13*var.FRT*x[0])/20)/10 + 1) + (ipca.G*x[12])/(ipca.km + x[12]) + ina.Gna*x[1]*x[1]*x[1]*x[2]*x[2]*(x[0] - var.RTF*log(ina.u1/(ina.u2 + x[15]))) + ito.Gto*x[5]*x[6]*(x[0] - var.RTF*log(ito.k1/(var.ki + ito.pnato*x[15]))) + (inak.G*inak.c1)/(((10*sqrt(10)*sqrt(1/x[15]))/x[15] + 1)*(inak.c3*exp(-var.FRT*x[0]) + inak.c2*exp(-(var.FRT*x[0])/10) + 1)) - (ik1.Gk1*ik1.c5*(var.Ek - x[0])*(exp(var.Ek/2 - x[0]/2) + 1))/((3*exp(ik1.c3*(ik1.c4 - var.Ek + x[0])) + exp(x[0]/10 - var.Ek/10 - 1))*(exp(-ik1.c1*(var.Ek + ik1.c2 - x[0])) + 1) + ik1.c5*(exp(var.Ek/2 - x[0]/2) + 1)) - (ical.gca*x[3]*x[4]*(ical.Eca - x[0]))/(x[12]/ical.kmmca + 1) - (ikr.Gkr*ikr.rate*x[7]*(var.Ek - x[0]))/(exp((ikr.k1 + x[0])/ikr.k2) + 1))/var.omega;
f[1]=-((ina.mc3*exp(-x[0]/ina.mc4) - (ina.mc1*(ina.mc2 + x[0]))/(exp(- ina.mc2/10 - x[0]/10) - 1))*(x[1] + (ina.mc1*(ina.mc2 + x[0]))/((ina.mc3*exp(-x[0]/ina.mc4) - (ina.mc1*(ina.mc2 + x[0]))/(exp(- ina.mc2/10 - x[0]/10) - 1))*(exp(- ina.mc2/10 - x[0]/10) - 1))))/var.omega;
f[2]=-(x[2] + tanh(ina.hc1 + ina.hc2*x[0])/2 - 0.5)/(var.omega*(ina.hc3 + (ina.hc4*(tanh(ina.hc1 + ina.hc2*x[0]) - 1))/(tanh(ina.hc5*(ina.hc6 + x[0])) - 1)));
f[3]=-(x[3] - 1/(exp(-(ical.dc1 + x[0])/ical.dc2) + 1))/(var.omega*(((7*ical.dc3)/5 + 49/(25*(exp(-(ical.dc4 + x[0])/ical.dc5) + 1)))/(exp(x[0]/5 + 1) + 1) + 1/(exp((ical.dc6 - x[0])/ical.dc7) + 1)));
f[4]=-((ical.kc6 + ical.kc3*exp(-ical.kc4*ical.kc4*(ical.kc7 - x[0])*(ical.kc7 - x[0])))*(x[4] - 1/(exp((ical.kc1 + x[0])/ical.kc2) + 1)))/(ical.kc5*var.omega);
f[5]=-((x[5] - (ito.c1*exp(ito.c2*(ito.c3 - x[0])))/((exp(ito.c4*(ito.c3 - x[0])) + 1)*((ito.c8*x[0] + ito.c5*exp(ito.c6*(ito.c7 - x[0])))/(exp(ito.c9*(ito.c8 - x[0])) + 1) + (ito.c1*exp(ito.c2*(ito.c3 - x[0])))/(exp(ito.c4*(ito.c3 - x[0])) + 1))))*((ito.c8*x[0] + ito.c5*exp(ito.c6*(ito.c7 - x[0])))/(exp(ito.c9*(ito.c8 - x[0])) + 1) + (ito.c1*exp(ito.c2*(ito.c3 - x[0])))/(exp(ito.c4*(ito.c3 - x[0])) + 1)))/var.omega;
f[6]=-(((ito.q4*x[0] + ito.q1*exp(-ito.q2*(ito.q3 + x[0])))/(exp(-ito.q5*(ito.q3 + x[0])) + 1) + (ito.q9*x[0] + ito.q6*exp(-ito.q7*(ito.q8 + x[0])))/(exp(-ito.q10*(ito.q8 + x[0])) + 1))*(x[6] - (ito.q1*exp(-ito.q2*(ito.q3 - ito.dVgq + x[0])) - ito.q4*(ito.dVgq - x[0]))/(((ito.q1*exp(-ito.q2*(ito.q3 - ito.dVgq + x[0])) - ito.q4*(ito.dVgq - x[0]))/(exp(-ito.q5*(ito.q3 - ito.dVgq + x[0])) + 1) + (ito.q6*exp(-ito.q7*(ito.q8 - ito.dVgq + x[0])) - ito.q9*(ito.dVgq - x[0]))/(exp(-ito.q10*(ito.q8 - ito.dVgq + x[0])) + 1))*(exp(-ito.q5*(ito.q3 - ito.dVgq + x[0])) + 1))))/var.omega;
f[7]=((x[7] - 1/(exp(- (10*x[0])/77 - 20.0/11.0) + 1))*((ikr.c1*(x[0] + 14))/(exp(- x[0]/5 - 14.0/5.0) - 1) + (ikr.c2*(ikr.c3 - x[0]))/(exp(-(ikr.c3 - x[0])/ikr.c4) - 1)))/var.omega;
f[8] = ((1.0/sqrt(1.0+exp(-(x[0]-9.4)/11.8)) - x[8])/(iks.c2/(1.0+exp(-(x[0]+22.0)/11.3))+iks.c1))/var.omega;
f[9] = ((1.0/(1.0+exp(-(x[0]+ical.dc1)/ical.dc2)) - x[9])/jrel.taudr)/var.omega;
f[10] = ((1.0/(1.0+exp((x[0]+ical.kc1)/ical.kc2)) - x[10])/jrel.taudf)/var.omega;
f[11] = (var.kktc*x[12]*(1.0-x[11])-var.kbtc*x[11])/var.omega;
f[12] = (1.0/(1.0+var.conccm*var.kdcm/((var.kdcm+x[12])*(var.kdcm+x[12])))*((-(ical.gca*(x[0]-ical.Eca)*x[3]*x[4]/(1.0+(x[12]/ical.kmmca)) +icab.pcab*(x[0]-0.5*var.RTF*log(2.0/x[12])) -2.0*ncx.c1*(2.0*x[15]*x[15]*x[15]*exp(0.35*var.FRT*x[0])-ncx.c2*x[12]*exp(-0.65*var.FRT*x[0]))/(1.0+0.1*exp(-0.65*var.FRT*x[0])) +ipca.G*x[12]/(ipca.km+x[12]) )*var.CapHV/(var.zca*F) + var.vrel*jrel.prel/(1.0+exp((ical.gca*(x[0]-ical.Eca)*x[3]*x[4]/(1.0+(x[12]/ical.kmmca)) + icab.pcab*(x[0]-0.5*var.RTF*log(2.0/x[12])) - 2.0*ncx.c1*(2.0*x[15]*x[15]*x[15]*exp(0.35*var.FRT*x[0])-ncx.c2*x[12]*exp(-0.65*var.FRT*x[0]))/(1.0+0.1*exp(-0.65*var.FRT*x[0])) + ipca.G*x[12]/(ipca.km+x[12]) + 5.0)/0.9))*x[9]*x[9]*x[9]*x[10]*x[10]*x[10]*(x[13]-x[12]) - var.vup*jup.pup*x[12]*x[12]/(x[12]*x[12] + jup.kup*jup.kup) + var.vup*jleak.pleak*(x[14]-x[12]))/var.vi-var.concTc*(var.kktc*x[12]*(1.0-x[11])-var.kbtc*x[11])))/var.omega;
f[13] = (1.0/(1.0+var.conccq*var.kdcq/((var.kdcq+x[13])*(var.kdcq+x[13])))*((x[14]-x[13])/jtr.tau - jrel.prel/(1.0+exp((ical.gca*(x[0]-ical.Eca)*x[3]*x[4]/(1.0+(x[12]/ical.kmmca)) + icab.pcab*(x[0]-0.5*var.RTF*log(2.0/x[12])) - 2.0*ncx.c1*(2.0*x[15]*x[15]*x[15]*exp(0.35*var.FRT*x[0])-ncx.c2*x[12]*exp(-0.65*var.FRT*x[0]))/(1.0+0.1*exp(-0.65*var.FRT*x[0])) + ipca.G*x[12]/(ipca.km+x[12]) + 5.0)/0.9))*x[9]*x[9]*x[9]*x[10]*x[10]*x[10]*(x[13]-x[12])))/var.omega;
f[14] = (jup.pup*x[12]*x[12]/(x[12]*x[12] + jup.kup*jup.kup) - var.vrel*((x[14]-x[13])/jtr.tau)/var.vup - jleak.pleak*(x[14]-x[12]))/var.omega;
f[15] = (-(ina.Gna*(x[0]-var.RTF*log(ina.u1/(x[15]+ina.u2)))*x[1]*x[1]*x[1]*x[2]*x[2] +inab.pnab*(x[0]-var.RTF*log(var.nao/x[15])) +3.0*inak.G*(inak.c1)/(1.0+(10.0/x[15])*sqrt(10.0/x[15]))/(1.0+inak.c2*exp(-0.1*var.FRT*x[0])+inak.c3*exp(-1.0*var.FRT*x[0])) +3.0*ncx.c1*(2.0*x[15]*x[15]*x[15]*exp(0.35*var.FRT*x[0])-ncx.c2*x[12]*exp(-0.65*var.FRT*x[0]))/(1.0+0.1*exp(-0.65*var.FRT*x[0])))*var.CapHV/(var.zna*F)/var.vi)/var.omega;

}
